# 产品需求文档：Lee's Online 个人主页网站 - V1.2

**文档版本**: 1.2
**创建日期**: 2025-01-30
**产品状态**: 开发中（OCR功能已完成）
**父版本**: v1.1
**文档作者**: Lee
**最后更新**: 2025-01-31

---

## 变更日志 (Changelog)

### 2025-01-31
- ✅ **完成 OCR 图片文字识别功能**
  - 创建独立页面 `ocr.html`
  - 集成 Coze API，使用正确的 `object_string` 格式
  - 实现图片上传、识别、复制功能
  - 添加详细的错误处理和进度提示
  - 测试通过，识别准确

- ✅ **完成 AI 资讯区块**
  - 实现"时间线+卡片"组合布局
  - 手动配置 3 条最新资讯（2025-01-31）
  - 来源：Jace煜橙、TRAE、小虎AI生活

- ✅ **完成 Skill 技能库链接**
  - 更新为外部链接 `https://skills.sh/`
  - 新标签页打开

- ✅ **优化思维导图工具**
  - 修复 SVG 加载卡顿问题（90% 卡住）
  - 改为始终渲染 SVG，使用加载遮罩

**当前进度**: 4/7 用户故事已完成（57%）

---

## 1. 综述 (Overview)

### 1.1 版本概述

**v1.2 是 v1.1 的功能扩展版本**，核心目标是增加产品深度和工具实用性。

**核心变更：**
1. 新增"拾光"产品独立详情页，含功能介绍和更新日志
2. 小工具区扩展为4个工具（2个可用 + 2个占位）
3. 资源库链接配置（提示词库接入飞书）
4. 新增"AI资讯"区块，时间线+卡片组合展示

### 1.2 核心业务流程 / 用户旅程地图

1.  **阶段一：认识 Lee** - 首屏了解 Lee 的故事
2.  **阶段二：了解作品** - 点击"拾光"进入详情页深入了解
3.  **阶段三：使用工具** - 使用灵感转思维导图、OCR等工具
4.  **阶段四：获取资源** - 访问提示词库（猫叔飞书）
5.  **阶段五：阅读资讯** - 浏览AI新闻区块
6.  **阶段六：建立连接** - 通过公众号或联系方式建立联系

### 1.3 Mermaid 图（流程/状态/时序）

#### 1.3.1 用户操作流（v1.2 变更部分）

```mermaid
flowchart TD
    A[访客进入首页] --> B[浏览首屏认识 Lee]
    B --> C[点击"拾光"卡片]
    C --> D[拾光详情页]
    D --> D1[查看功能介绍]
    D --> D2[查看更新日志]
    D --> E[返回首页]

    E --> F[滚动到小工具区]
    F --> G{选择工具}
    G -->|灵感转导图| H[跳转到思维导图工具]
    G -->|OCR| I[弹出OCR窗口]
    G -->|红包制作| J[敬请期待提示]
    G -->|文档校对| K[敬请期待提示]

    I --> I1[上传图片]
    I1 --> I2[扣子Agent识别]
    I2 --> I3[显示结果/复制]

    H --> L[返回首页]
    I3 --> L

    L --> M[浏览资源库]
    M --> M1[点击提示词库]
    M1 --> M2[新标签打开猫叔飞书]

    M --> N[浏览AI资讯]
    N --> N1[点击感兴趣的新闻]
    N1 --> N2[跳转到原文]

    N --> O[底部建立联系]
```

---

## 2. 用户故事详述 (User Stories)

### 阶段二：了解作品（v1.2 新增详情页）

---

#### **US-01: 作为访客，我希望查看"拾光"产品的详细介绍和更新历史，以便全面了解产品功能。**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 能够查看"拾光"产品的详细介绍和更新历史
    *   **以便于** 全面了解产品功能，决定是否使用
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页产品区
    2.  **操作流程 (Happy Path)**:
        1. 点击"拾光"产品卡片进入详情页
        2. 页面路径：`/products/shiguang`
        3. 页面内容包括：
           - 产品标题 + Slogan
           - 功能特性列表（6个核心功能）
           - 使用场景说明
           - 更新日志（嵌入飞书文档 `https://pcn6dg6krayk.feishu.cn/docx/R6YEdtX8JoImvJxd6kwc1irhn9b`）
        4. **功能特性文案**：
           - **资源智能收集** - 粘贴链接自动识别标题内容，支持图片、文档、网页一键保存，AI 自动提取关键信息
           - **灵感随时记录** - 语音输入快速捕捉想法，支持位置标记，不错过任何一个灵感瞬间
           - **多维分类管理** - 无限层级文件夹 + 多标签系统，拖拽整理，支持 AND 多标签组合筛选
           - **每日运势抽签** - AI 根据生辰生成专属日签，图文结合，为每一天增添仪式感
           - **全局极速搜索** - 名称、标签、笔记、内容全文检索，秒级定位所需资料
           - **智能AI分类** - 自动识别资源类型，智能归类整理，告别杂乱文件夹
        5. **使用场景**：
           - 网页资料收藏与后续阅读
           - 设计灵感/创意想法管理
           - 个人知识库搭建
           - 日常信息碎片化整理
    3.  **异常处理 (Error Handling)**:
        - 飞书文档加载失败时显示"更新日志加载失败，请稍后重试"
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 进入详情页**
        *   **GIVEN** 访客在首页
        *   **WHEN** 点击"拾光"卡片
        *   **THEN** 跳转到详情页 `/products/shiguang`
    *   **场景2: 查看更新日志**
        *   **GIVEN** 访客在详情页
        *   **WHEN** 滚动到更新日志区块
        *   **THEN** 正确嵌入飞书文档并显示内容
    *   **场景3: 响应式布局**
        *   **GIVEN** 访客使用移动设备
        *   **WHEN** 查看详情页
        *   **THEN** 内容正常显示，无布局错乱
*   **页面布局线框图 (ASCII Wireframe)**:
    ```text
    +--------------------------------------------------------------------------+
    | [← 返回首页]               LEE'S ONLINE                        [☀ 浅色 ] |
    +==========================================================================+
    |                                                                          |
    |                           // PRODUCT                                     |
    |                            拾 光                                         |
    |                                                                          |
    |   ┌──────────────────────────────────────────────────────────────────┐   |
    |   |                                                                  |   |
    |   |   智能资料存储系统                                                |   |
    |   |   让每一个灵感都有归属                                            |   |
    |   |                                                                  |   |
    |   |   [ 立即使用 ]                                                    |   |
    |   |                                                                  |   |
    |   └──────────────────────────────────────────────────────────────────┘   |
    |                                                                          |
    +--------------------------------------------------------------------------+
    |  // 功能特性                                                              |
    |                                                                          |
    |  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐         |
    |  │ 资源智能   │  │ 灵感随时   │  │ 多维分类   │  │ 每日运势   │         |
    |  │ 收集       │  │ 记录       │  │ 管理       │  │ 抽签       │         |
    |  └────────────┘  └────────────┘  └────────────┘  └────────────┘         |
    |                                                                          |
    |  ┌────────────┐  ┌────────────┐                                         |
    |  │ 全局极速   │  │ 智能AI     │                                         |
    |  │ 搜索       │  │ 分类       │                                         |
    |  └────────────┘  └────────────┘                                         |
    |                                                                          |
    +--------------------------------------------------------------------------+
    |  // 使用场景                                                              |
    |  网页资料收藏 · 设计灵感管理 · 个人知识库 · 碎片化信息整理                 |
    |                                                                          |
    +--------------------------------------------------------------------------+
    |  // 更新日志                                                              |
    |  ┌──────────────────────────────────────────────────────────────────┐   |
    |  │                                                                  │   |
    |  │   [ 飞书文档嵌入区域 ]                                            │   |
    |  │   https://pcn6dg6krayk.feishu.cn/docx/...                        │   |
    |  │                                                                  │   |
    |  └──────────────────────────────────────────────────────────────────┘   |
    |                                                                          |
    +--------------------------------------------------------------------------+
    |                           [ 底部导航 ]                                   |
    +--------------------------------------------------------------------------+
    ```

---

### 阶段三：使用工具（v1.2 扩展）

---

#### **US-02: 作为访客，我希望将灵感输入后自动整理成思维导图，以便快速可视化思路。**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 能够将零散灵感输入后自动整理成思维导图
    *   **以便于** 快速可视化整理思路，减少手动分类负担
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页小工具区
    2.  **操作流程 (Happy Path)**:
        1. 点击"灵感转思维导图"卡片
        2. 跳转到独立页面 `/tools/mindmap`
        3. 复用 E:\Work\LingGanMaster 的代码
        4. 核心功能：
           - 文本框输入灵感（最多500字）
           - AI 自动分析并归类到现有分支或创建新分类
           - 自动生成可交互的思维导图（支持展开/收起、拖拽、缩放）
           - 导出 Markdown 文件
        5. 数据存储：localStorage 本地缓存
    3.  **异常处理 (Error Handling)**:
        - AI 分类失败时提示"分类失败，请重试"
        - localStorage 满时提示清理空间
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 跳转工具页**
        *   **GIVEN** 访客在首页
        *   **WHEN** 点击"灵感转思维导图"卡片
        *   **THEN** 跳转到 `/tools/mindmap`
    *   **场景2: 生成思维导图**
        *   **GIVEN** 访客在工具页
        *   **WHEN** 输入灵感并提交
        *   **THEN** AI 自动分类并生成思维导图
    *   **场景3: 数据持久化**
        *   **GIVEN** 访客刷新页面
        *   **WHEN** 重新打开工具
        *   **THEN** 之前的数据从 localStorage 恢复
*   **页面布局线框图 (ASCII Wireframe)**:
    ```text
    +--------------------------------------------------------------------------+
    | [← 返回首页]               LEE'S ONLINE                        [☀ 浅色 ] |
    +==========================================================================+
    |                                                                          |
    |                    // 灵感转思维导图                                      |
    |                                                                          |
    |  ┌──────────────────────────────────────────────────────────────────┐   |
    |  │                                                                  │   |
    |  │  输入你的想法：                                                   │   |
    |  │  ┌────────────────────────────────────────────────────────────┐ │   |
    |  │  │ 我要做一个个人网站，包含首页、产品展示、小工具...           │ │   |
    |  │  └────────────────────────────────────────────────────────────┘ │   |
    |  │                                                                  │   |
    |  │  0/500 字    [ 添加灵感 ]  或按 Ctrl+Enter                      │   |
    |  │                                                                  │   |
    |  └──────────────────────────────────────────────────────────────────┘   |
    |                                                                          |
    |  ┌──────────────────────────────────────────────────────────────────┐   |
    |  │                                                                  │   |
    |  │                    [ 思维导图可视化区域 ]                         │   |
    |  │                                                                  │   |
    |  │                         我的灵感                                 │   |
    |  │                        /        \                               │   |
    |  │                产品功能          待开发                         │   |
    |  │               /       \            \                            │   |
    |  │          个人网站    定时任务      灵感工具                      │   |
    |  │         /      \                                               │   |
    |  │      首页    产品展示                                           │   |
    |  │                                                                  │   |
    |  │  [ 拖拽移动 ] [ 滚轮缩放 ] [ 点击展开/收起 ]                      │   |
    |  │                                                                  │   |
    |  └──────────────────────────────────────────────────────────────────┘   |
    |                                                                          |
    |                              [ 导出 Markdown ]                          |
    |                                                                          |
    +--------------------------------------------------------------------------+
    ```

---

#### **US-03: 作为访客，我希望上传图片后提取文字内容，以便快速获取图片中的文本。**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 上传图片后能提取其中的文字内容
    *   **以便于** 快速获取图片中的文本信息，无需手动输入
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页小工具区
    2.  **操作流程 (Happy Path)**:
        1. 点击"图片文字解析"卡片
        2. 弹出 OCR 工具窗口（Dialog/Modal）
        3. 左右分栏布局：
           - **左侧**：上传区域 + 图片预览
           - **右侧**：识别结果 + 操作按钮
        4. 支持拖拽上传图片（单张，最大 5MB）
        5. 点击"开始识别"调用扣子(Coze) Agent
        6. 显示识别结果，支持一键复制
    3.  **技术实现**:
        - **实现方式**: 独立 HTML 页面 `ocr.html`（非 React 组件）
        - **AI服务**: Coze API（扣子平台）
        - **API格式**:
          ```json
          {
            "bot_id": "7601407430056083494",
            "user_id": "123456789",
            "stream": false,
            "additional_messages": [{
              "role": "user",
              "content": "[{\"type\":\"text\",\"text\":\"请识别这张图片中的所有文字内容，只返回识别出的文字，不要添加任何解释。\"},{\"type\":\"image\",\"file_id\":\"文件ID\"}]",
              "content_type": "object_string"
            }]
          }
          ```
        - **文件上传**: `POST /v1/files/upload` → 返回 `file_id`
        - **识别流程**: 上传 → 调用Chat → 轮询结果 → 获取文字
        - **进度显示**: "正在上传图片..." → "正在调用 AI 识别..." → "识别完成"
    4.  **异常处理 (Error Handling)**:
        - 图片格式不支持时提示"请上传 JPG 或 PNG 格式图片"
        - 图片过大时提示"图片大小超过 5MB 限制"
        - 识别失败时提示"识别失败，请重试或更换图片"
        - 识别超时（30秒）提示"识别超时，请重试"
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 打开OCR弹窗** ✅
        *   **GIVEN** 访客在首页
        *   **WHEN** 点击"图片文字解析"卡片
        *   **THEN** 弹出 OCR 工具窗口
    *   **场景2: 上传图片** ✅
        *   **GIVEN** OCR 窗口已打开
        *   **WHEN** 拖拽或点击上传图片
        *   **THEN** 左侧显示图片预览
    *   **场景3: 文字识别** ✅
        *   **GIVEN** 已上传图片
        *   **WHEN** 点击"开始识别"
        *   **THEN** 右侧显示识别结果（测试通过）
    *   **场景4: 复制结果** ✅
        *   **GIVEN** 识别结果已显示
        *   **WHEN** 点击"复制结果"
        *   **THEN** 文字复制到剪贴板
*   **实现状态**: ✅ 已完成（2025-01-31）
*   **页面布局线框图 (ASCII Wireframe)**:
    ```text
    +--------------------------------------------------------------------------+
    |                              [ 遮罩层 ]                                   |
    |                                                                          |
    |  +---------------------------------------------------------------+      |
    |  |  // OCR 图片文字识别                                 [ × ]    |      |
    |  |                                                               |      |
    |  |  +------------------------++-------------------------------+  |      |
    |  |  |                        ||                               |  |      |
    |  |  |  上传图片               ||  识别结果                     |  |      |
    |  |  |                        ||                               |  |      |
    |  |  |  ┌──────────────────┐  ||  ┌─────────────────────────┐  |  |      |
    |  |  │  │                  │  ||  │                         │  |  |      |
    |  |  │  │  [拖拽图片到      │  ||  │  等待上传图片...         │  |  |      |
    |  |  │  │   这里或点击      │  ||  │                         │  |  |      |
    |  |  │  │   上传]          │  ||  │                         │  |  |      |
    |  |  │  │                  │  ||  │                         │  |  |      |
    |  |  │  │  支持 JPG、PNG   │  ||  │                         │  |  |      |
    |  |  │  │  最大 5MB        │  ||  │                         │  |  |      |
    |  |  │  │                  │  ||  │                         │  |  |      |
    |  |  └──────────────────┘  ||  └─────────────────────────┘  |  |      |
    |  |  |                        ||                               |  |      |
    |  |  |  [ 选择图片 ]           ||                               |  |      |
    |  |  |                        ||                               |  |      |
    |  |  +------------------------++-------------------------------+  |      |
    |  |                                                               |      |
    |  +---------------------------------------------------------------+      |
    |                                                                          |
    +--------------------------------------------------------------------------+
    ```

    **识别完成状态：**
    ```
    +---------------------------------------------------------------+
    |  // OCR 图片文字识别                                 [ × ]    |
    |                                                               |
    |  +------------------------++-------------------------------+  |
    |  |  上传图片               ||  识别结果                     |  |
    |  |                        ||                               |  |
    |  |  ┌──────────────────┐  ||  ┌─────────────────────────┐  |  |
    |  |  │  ┌──────────┐    │  ||  │ 这是识别出的文字内容     │  |  |
    |  |  │  │[图片预览] │    │  ||  │ 可以跨越多行显示        │  |  |
    |  |  │  │ screenshot│    │  ||  │                         │  |  |
    |  |  │  └──────────┘    │  ||  │ 第二段文字...           │  |  |
    |  |  │                  │  ||  │                         │  |  |
    |  |  │  screenshot.png  │  ||  │ 第三段文字...           │  |  |
    |  |  │  2.3 MB          │  ||  │                         │  |  |
    |  |  └──────────────────┘  ||  └─────────────────────────┘  |  |
    |  |                        ||                               |  |
    |  |  [ 重新选择 ]           ||  [ 复制结果 ]  [ 重新识别 ]   |  |
    |  |                        ||                               |  |
    |  +------------------------++-------------------------------+  |
    |                                                               |
    +---------------------------------------------------------------+
    ```

---

#### **US-04: 作为访客，我希望制作个性化的微信红包封面，以便在特殊场合发送特色红包。（已迁移至 PRD-002）**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 能够制作个性化的微信红包封面
    *   **以便于** 在节日或特殊场合发送有特色的红包

*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页小工具区
    2.  **操作流程 (Happy Path)**:
        1. 卡片显示"敬请期待"或"开发中"状态
        2. 点击跳转至独立项目页面（红包封面制作工具）
    3.  **说明**：此功能已独立为单独项目，详见 **PRD-002: 微信红包封面制作工具**

*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 占位显示**
        *   **GIVEN** 访客在首页
        *   **WHEN** 查看小工具区
        *   **THEN** "微信红包封面"卡片显示引导文字
    *   **场景2: 跳转工具**
        *   **GIVEN** 访客点击该卡片
        *   **WHEN** 点击完成
        *   **THEN** 跳转至红包封面制作工具独立页面

---

#### **US-05: 作为访客，我希望检查文档中的错别字和语法错误，以便提升文档质量。（占位）**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 能够检查文档中的错别字和语法错误
    *   **以便于** 提升文档质量，避免低级错误
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页小工具区
    2.  **操作流程 (Happy Path)**:
        1. 卡片显示"敬请期待"或"开发中"状态
        2. 点击显示 Toast 提示"功能开发中，敬请期待"
    3.  **未来规划**（v1.3+）：
        - 粘贴文本或上传文档
        - AI 检查错别字、语法、标点
        - 高亮标注问题并提供修改建议
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 占位显示**
        *   **GIVEN** 访客在首页
        *   **WHEN** 查看小工具区
        *   **THEN** "文档校对"卡片显示"敬请期待"
    *   **场景2: 点击提示**
        *   **GIVEN** 访客点击该卡片
        *   **WHEN** 点击完成
        *   **THEN** 显示"功能开发中，敬请期待"提示

---

### 阶段四：获取资源（v1.2 链接配置）

---

#### **US-06: 作为访客，我希望点击资源库卡片能跳转到实际的提示词库，以便获取可用的 AI 提示词。**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 点击资源库卡片能跳转到实际的提示词库
    *   **以便于** 获取可用的 AI 提示词和技能模板
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页资源库区
    2.  **操作流程 (Happy Path)**:
        1. **提示词库**：
           - 点击卡片跳转猫叔的飞书文档
           - 链接：`https://z0x8z83m7x.feishu.cn/docx/CpRpddnOQoVPpKxeXnAc3vBvn6f?sessionid=`
           - 新标签页打开
           - 卡片显示标注"猫叔的提示词"
        2. **Skill技能库**：
           - 开发中，点击显示"即将上线"提示
    3.  **异常处理 (Error Handling)**:
        - 飞书文档无法访问时显示友好提示
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 提示词库跳转**
        *   **GIVEN** 访客点击"提示词库"卡片
        *   **WHEN** 点击完成
        *   **THEN** 新标签页打开猫叔的飞书文档
    *   **场景2: Skill技能库占位**
        *   **GIVEN** 访客点击"Skill技能库"卡片
        *   **WHEN** 点击完成
        *   **THEN** 显示"即将上线"提示

---

### 阶段五：阅读资讯（v1.2 新增区块）

---

#### **US-07: 作为访客，我希望浏览最新的 AI 行业新闻和动态，以便快速了解 AI 领域的前沿信息。**

*   **价值陈述 (Value Statement)**:
    *   **作为** 访客
    *   **我希望** 浏览最新的 AI 行业新闻和动态
    *   **以便于** 快速了解 AI 领域的前沿信息
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 访客在首页，滚动到 AI资讯区块
    2.  **操作流程 (Happy Path)**:
        1. 区块位置：资源库区下方
        2. 区块标题：`06  AI资讯`
        3. **展示形式**：时间线+卡片组合
           - 按月份分组（如"2025年1月"）
           - 每个日期节点下横向排列当天的新闻卡片
           - 卡片显示：来源Logo、标题、来源名称、日期
        4. **v1.2 方案（手动配置）**：
           - 在代码/配置文件中预设新闻列表
           - 每条新闻包含：标题、链接、来源、日期
           - 初期展示 5-10 条
        5. 点击卡片新标签页打开原文
    3.  **未来规划（v1.3+）**：
        - 升级为 CMS 后台管理
        - 支持动态添加/编辑/删除
    4.  **异常处理 (Error Handling)**:
        - 暂无新闻时显示"暂无资讯，敬请期待"
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 区块展示**
        *   **GIVEN** 访客滚动到 AI资讯区块
        *   **WHEN** 区块进入视口
        *   **THEN** 显示时间线+卡片组合的新闻列表
    *   **场景2: 点击跳转**
        *   **GIVEN** 访客点击某条新闻卡片
        *   **WHEN** 点击完成
        *   **THEN** 新标签页打开原文链接
    *   **场景3: 响应式布局**
        *   **GIVEN** 访客使用移动设备
        *   **WHEN** 查看AI资讯区块
        *   **THEN** 卡片自适应单列显示
*   **页面布局线框图 (ASCII Wireframe)**:
    ```text
    +--------------------------------------------------------------------------+
    | 06  AI资讯                                                               |
    +--------------------------------------------------------------------------+
    |                                                                          |
    |                             2025年1月                                    |
    |                                                                          |
    |  ───────────●─────────────                                               |
    |           01/28                                                          |
    |                                                                          |
    |  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                   |
    |  │              │  │              │  │              │                   |
    |  │  [机器之心]   │  │  [钛媒体]     │  │  [36氪]      │                   |
    |  │              │  │              │  │              │                   |
    |  │ OpenAI发布   │  │  阿里通义千问  │  │  Anthropic   │                   |
    |  │ GPT-5预览版  │  │  开源新模型   │  │  融资35亿    │                   |
    |  │              │  │              │  │              │                   |
    |  │  机器之心    │  │  钛媒体       │  │  36氪        │                   |
    |  │  2025-01-28 │  │  2025-01-28  │  │  2025-01-28  │                   |
    |  └──────────────┘  └──────────────┘  └──────────────┘                   |
    |                                                                          |
    |  ───────────●─────────────                                               |
    |           01/27                                                          |
    |                                                                          |
    |  ┌──────────────┐  ┌──────────────┐                                     |
    |  │              │  │              │                                     |
    |  │  [AI前线]     │  │  [开源中国]   │                                     |
    |  │              │  │              │                                     |
    |  │ Claude新功能 │  │  Meta发布    │                                     |
    |  │ 代码解释器   │  │  Llama 3     │                                     |
    |  │              │  │              │                                     |
    |  │  AI前线      │  │  开源中国    │                                     |
    |  │  2025-01-27 │  │  2025-01-27  │                                     |
    |  └──────────────┘  └──────────────┘                                     |
    |                                                                          |
    |                           [ 查看更多 → ]                                 |
    |                                                                          |
    +--------------------------------------------------------------------------+
    ```

---

## 3. 变更影响分析

### 3.1 数据结构变更

**新增配置项：**

```typescript
// 产品详情页配置
interface ProductDetailConfig {
  shiguang: {
    features: string[];        // 功能特性列表
    useCases: string[];        // 使用场景
    changelogUrl: string;      // 飞书文档链接
  }
}

// 小工具配置
interface ToolConfig {
  mindmap: {
    enabled: true;
    path: '/tools/mindmap';
    storage: 'localStorage';
  };
  ocr: {
    enabled: true;
    type: 'modal';
    aiProvider: 'coze';
  };
  redpacket: {
    enabled: false;  // 占位
    message: '功能开发中，敬请期待';
  };
  proofread: {
    enabled: false;  // 占位
    message: '功能开发中，敬请期待';
  };
}

// 资源库链接配置
interface ResourceLinks {
  promptLibrary: {
    name: '猫叔的提示词';
    url: 'https://z0x8z83m7x.feishu.cn/docx/CpRpddnOQoVPpKxeXnAc3vBvn6f?sessionid=';
    enabled: true;
  };
  skillLibrary: {
    enabled: false;
    message: '即将上线';
  };
}

// AI新闻配置（v1.2 手动配置）
interface NewsItem {
  title: string;
  url: string;
  source: string;      // 来源名称
  sourceLogo?: string; // 来源Logo（可选）
  date: string;        // YYYY-MM-DD
}

interface NewsConfig {
  items: NewsItem[];   // 手动配置的新闻列表
}
```

### 3.2 页面结构变更

**变更前：**
```
首屏 → 产品区 → 小工具区（2个） → 资源库 → 推荐工具 → 底部
```

**变更后：**
```
首屏 → 产品区（拾光可跳转详情页） → 小工具区（4个） → 资源库（有链接） → AI资讯（新增） → 推荐工具 → 底部
                                           ↓
                              思维导图（新页面）/ OCR（弹窗）
```

**新增路由：**
- `/products/shiguang` - 拾光详情页
- `/tools/mindmap` - 灵感转思维导图工具

### 3.3 样式变更

**新增样式类：**
- `.product-detail`: 产品详情页布局
- `.tool-modal`: 工具弹窗样式
- `.ocr-split-layout`: OCR 左右分栏布局
- `.news-timeline`: 时间线样式
- `.news-card-grid`: 新闻卡片网格

---

## 4. 非功能需求 (Non-Functional Requirements)

### 4.1 性能要求
- **详情页加载**: 首屏 < 2s，飞书文档嵌入懒加载
- **OCR识别**: 图片上传 < 3s，识别结果返回 < 5s
- **思维导图**: 本地渲染，支持100+节点流畅交互

### 4.2 可访问性 (A11y)
- **弹窗**: 支持 ESC 键关闭，焦点 trapped 在弹窗内
- **图片上传**: 支持键盘操作，有明确的焦点指示
- **时间线**: 使用语义化 HTML，屏幕阅读器友好

### 4.3 浏览器兼容性
- 与 v1.1 保持一致
- 思维导图工具使用 markmap，需测试 Safari 兼容性

---

## 5. 版本对比

| 功能 | v1.1 | v1.2 |
|------|------|------|
| 首屏 | 个人简介+时间线+最新动态 | 无变更 |
| 产品区 | 拾光卡片 | **新增详情页跳转** |
| 小工具区 | 2个占位 | **4个工具（2可用+2占位）** |
| 资源库 | 占位 | **提示词库链接配置** |
| AI资讯 | ✗ | **✓ 新增区块** |
| 推荐工具 | 开发工具优先 | 无变更 |
| 底部 | ✓ | 无变更 |

---

## 6. 开发任务清单

- [ ] **US-01**: 拾光产品详情页
  - [ ] 创建 `/products/shiguang` 页面
  - [ ] 功能特性展示（6个特性）
  - [ ] 飞书文档嵌入（更新日志）
  - [ ] 响应式布局

- [-] **US-02**: 灵感转思维导图工具（部分完成）
  - [x] 复用 LingGanMaster 代码
  - [x] 创建 `/tools/mindmap` 页面
  - [x] 调整样式与首页一致
  - [x] localStorage 数据持久化
  - [x] 修复加载卡顿问题（SVG渲染优化）
  - [ ] 优化AI分类准确性（可选）

- [x] **US-03**: OCR 图片文字解析 ✅ 已完成（2025-01-31）
  - [x] 创建独立 HTML 页面 `ocr.html`
  - [x] 左右分栏布局实现
  - [x] 图片上传功能（拖拽+点击）
  - [x] 扣子 Agent 集成（Coze API）
  - [x] API 格式调试（object_string）
  - [x] 结果复制功能
  - [x] 错误处理和提示

- [ ] **US-04**: 微信红包封面工具（跳转至独立项目）
  - [ ] 首页卡片显示引导文字
  - [ ] 点击跳转至 PRD-002 红包封面制作工具独立页面
  - [ ] 详见 PRD-002: 微信红包封面制作工具

- [ ] **US-05**: 文档校对（占位）
  - [ ] 卡片显示"敬请期待"
  - [ ] 点击提示功能开发中

- [x] **US-06**: 资源库链接配置 ✅ 已完成
  - [x] 提示词库链接配置（猫叔飞书）
  - [x] Skill技能库链接配置（skills.sh）

- [x] **US-07**: AI资讯区块 ✅ 已完成（2025-01-31）
  - [x] 时间线+卡片组合布局
  - [x] 新闻数据结构定义
  - [x] 手动配置3条新闻（2025-01-31）
  - [ ] 升级为 CMS 后台管理（v1.3+）

### 进度总结

**已完成功能：**
- ✅ US-02: 灵感转思维导图工具
- ✅ US-03: OCR 图片文字解析
- ✅ US-06: 资源库链接配置
- ✅ US-07: AI资讯区块

**待开发功能：**
- ⏳ US-01: 拾光产品详情页
- ⏳ US-04: 微信红包封面工具（独立项目）
- ⏳ US-05: 文档校对（占位）

**当前完成度：4/7 用户故事（57%）**

---

## 7. 测试验收

### 7.1 功能测试

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|----------|----------|------|
| 拾光详情页 | 点击"拾光"卡片 | 跳转到详情页，显示功能介绍 | ⏳ 待测试 |
| 更新日志 | 滚动到更新日志区块 | 飞书文档正确嵌入显示 | ⏳ 待测试 |
| 思维导图 | 点击工具卡片 | 跳转到思维导图工具页 | ✅ 已通过 |
| 思维导图加载 | 刷新页面 | SVG正常渲染，不卡在90% | ✅ 已通过 |
| OCR弹窗 | 点击OCR卡片 | 弹出左右分栏窗口 | ✅ 已通过 |
| OCR上传 | 拖拽图片到上传区 | 左侧显示图片预览 | ✅ 已通过 |
| OCR识别 | 上传图片并点击识别 | 右侧显示识别结果 | ✅ 已通过 |
| OCR复制 | 点击"复制结果" | 文字复制到剪贴板 | ✅ 已通过 |
| 占位工具 | 点击红包/校对卡片 | 显示"敬请期待"提示 | ✅ 已通过 |
| 提示词库 | 点击提示词库卡片 | 新标签打开猫叔飞书文档 | ✅ 已通过 |
| Skill技能库 | 点击技能库卡片 | 新标签打开 skills.sh | ✅ 已通过 |
| AI资讯 | 滚动到AI资讯区块 | 显示时间线+卡片布局 | ✅ 已通过 |
| 新闻跳转 | 点击新闻卡片 | 新标签打开原文链接 | ✅ 已通过 |

### 7.2 兼容性测试

- [x] Chrome/Edge 最新版 ✅
- [ ] Firefox 最新版
- [ ] Safari 最新版
- [ ] iOS Safari 14+
- [ ] 移动端响应式

---

## 8. 附录

### 8.1 外部链接汇总

| 用途 | 链接 |
|------|------|
| 拾光更新日志 | `https://pcn6dg6krayk.feishu.cn/docx/R6YEdtX8JoImvJxd6kwc1irhn9b` |
| 猫叔提示词库 | `https://z0x8z83m7x.feishu.cn/docx/CpRpddnOQoVPpKxeXnAc3vBvn6f?sessionid=` |
| Skill技能库 | `https://skills.sh/` |
| Coze API 文档 | `https://www.coze.cn/docs/developer_guides/api_overview` |

### 8.2 参考代码路径

| 功能 | 参考路径 |
|------|----------|
| 灵感转思维导图 | `E:\Work\LingGanMaster` |
| 拾光产品 | `E:\Work\TimePick` |
| OCR 图片识别 | `E:\Work\Lee_Online\ocr.html` |

### 8.3 技术实现要点

#### OCR 功能关键实现

**Coze API 调用格式：**
```javascript
// 1. 上传文件
POST https://api.coze.cn/v1/files/upload
Headers: { "Authorization": "Bearer YOUR_API_KEY" }
Body: FormData { file: <图片文件> }
Response: { code: 0, data: { id: "file_id" } }

// 2. 调用识别
POST https://api.coze.cn/v3/chat
Headers: { "Authorization": "Bearer YOUR_API_KEY", "Content-Type": "application/json" }
Body: {
  bot_id: "YOUR_BOT_ID",
  user_id: "123456789",
  stream: false,
  additional_messages: [{
    role: "user",
    content: "[{\"type\":\"text\",\"text\":\"请识别...\"},{\"type\":\"image\",\"file_id\":\"...\"}]",
    content_type: "object_string"  // 关键：使用 object_string
  }]
}

// 3. 轮询结果
GET https://api.coze.cn/v3/chat/retrieve?conversation_id={id}&chat_id={id}
Response: { data: { status: "completed" } }

// 4. 获取消息
GET https://api.coze.cn/v3/chat/message/list?conversation_id={id}&chat_id={id}
Response: { data: [{ role: "assistant", content: "识别结果" }] }
```

**关键调试经验：**
1. ❌ 错误格式：`content_type: "multimodal_text"` → 4000 错误
2. ✅ 正确格式：`content_type: "object_string"` → 成功
3. `content` 必须是 JSON 数组字符串，包含 `type`、`text`/`file_id` 字段
4. 图片必须和文本在同一个数组中，不能分开两条消息
